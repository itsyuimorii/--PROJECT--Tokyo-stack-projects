/* TODO: routeræ–‡ä»¶å¤¹ä¸­è¿‡ä¸“é—¨ç”¨æ¥å­˜æ”¾æ‰€æœ‰çš„è·¯ç”±æ¨¡å—.è·¯ç”±æ¨¡å—ä¸­,
  å€¼å­˜æ”¾å¯äº’å…³çš„è¯·æ±‚å’Œå¤„ç†å‡½æ•°ä¹‹é—´çš„æ˜ å°„å…³ç³»; */

//ğŸ‘‡user.js ä½œä¸ºç”¨æˆ·çš„è·¯ç”±æ¨¡å—, å¹¶åˆå§‹åŒ–ä»£ç å¦‚ä¸‹ğŸ‘‡

//å¯¼å…¥express
const express = require("express");
//åˆ›å»ºè·¯ç”±å¯¹è±¡,ç”¨å¸¸é‡router æ¥æ¥æ”¶
const router = express.Router();

//å¯¼å…¥ç”¨æˆ·è·¯ç”±å¤„ç†å‡½æ•°å¯¹åº”çš„æ¨¡å—
const user_handler = require("../router_handler/user");

///////////////////å¯¼å…¥éªŒè¯
//1. å¯¼å…¥éªŒè¯è¡¨å•æ•°æ®çš„ä¸­é—´ä»¶ ,å°†ä¸­é—´ä»¶åœ¨å¯¹åº”çš„è·¯ç”±ä¸­è¿›è¡Œè°ƒç”¨ router.post
const expressJoi = require("@escook/express-joi");
//2. å¯¼å…¥éœ€è¦éªŒè¯çš„è§„åˆ™å¯¹è±¡ (è§£æ„èµ‹å€¼)
const { reg_login_schema } = require("../schema/user");

////////////////////////æŒ‚è½½ä¸¤ä¸ªè·¯ç”±,ç›‘å¬å®¢æˆ·ç«¯çš„è¯·æ±‚
// 3.  åœ¨æ³¨å†Œæ–°ç”¨æˆ·çš„è·¯ç”±ä¸­ï¼Œå£°æ˜å±€éƒ¨ä¸­é—´ä»¶ï¼Œå¯¹å½“å‰è¯·æ±‚ä¸­æºå¸¦çš„æ•°æ®è¿›è¡ŒéªŒè¯
// 3.1 æ•°æ®éªŒè¯é€šè¿‡åï¼Œä¼šæŠŠè¿™æ¬¡è¯·æ±‚æµè½¬ç»™åé¢çš„è·¯ç”±å¤„ç†å‡½æ•°
// 3.2 æ•°æ®éªŒè¯å¤±è´¥åï¼Œç»ˆæ­¢åç»­ä»£ç çš„æ‰§è¡Œï¼Œå¹¶æŠ›å‡ºä¸€ä¸ªå…¨å±€çš„ Error é”™è¯¯ï¼Œè¿›å…¥å…¨å±€é”™è¯¯çº§åˆ«ä¸­é—´ä»¶ä¸­è¿›è¡Œå¤„ç†

//æ³¨å†Œæ–°ç”¨æˆ·
//ç”¨ä¸­é—´ä»¶(expressJoi(reg_login_schema))è¿›è¡ŒéªŒè¯, å¦‚é€šè¿‡,é‚£ä¹ˆè¿›è¡Œuser_handler.regUserå¤„ç†å‡½æ•°, å¦‚æœæ²¡æœ‰, å°±æ•è·é”™è¯¯, åœ¨app.jsä¸­è®¾ç½®
router.post("/reguser", expressJoi(reg_login_schema), user_handler.regUser);
//ç™»å½•
router.post("/login", expressJoi(reg_login_schema), user_handler.login);

//æš´éœ²å‡ºå», å†app.jsä¸­å¯¼å…¥å¹¶ä½¿ç”¨ç”¨æˆ·æ¨¡å—
module.exports = router;
